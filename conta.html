<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Minha Conta – Guia Parque Andreense</title>
  <link rel="stylesheet" href="assets/css/global.css">
  <link rel="stylesheet" href="assets/css/provider.css"> <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  
  <script type="text/javascript" src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
</head>
<body>
  <header>
    <div class="wrap">
      <a href="/" style="color:#fff;text-decoration:none">← Voltar para o Início</a>
    </div>
  </header>

  <main class="wrap">
    <div id="account-container" class="card">
      <div id="user-info" style="display: none;">
        <h1>Minha Conta</h1>
        <p>Bem-vindo(a) de volta!</p>
        <p><strong>Email:</strong> <span id="user-email"></span></p>
        <button id="logout-button" class="cta secondary-cta">Sair (Logout)</button>
      </div>

      <div id="login-prompt">
        <h1>Acessar sua Conta</h1>
        <p>Para avaliar um serviço, você precisa fazer login ou criar uma conta.</p>
        <button id="login-button" class="cta">Fazer Login ou Cadastrar</button>
      </div>
    </div>
  </main>
  
  <footer>
    <div class="wrap">© <span id="year"></span> Guia Parque Andreense</div>
  </footer>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const userInfoDiv = document.getElementById('user-info');
      const loginPromptDiv = document.getElementById('login-prompt');
      const userEmailSpan = document.getElementById('user-email');
      const loginButton = document.getElementById('login-button');
      const logoutButton = document.getElementById('logout-button');

      // Função para atualizar a interface baseado no status do usuário
      const updateUserUI = (user) => {
        if (user) {
          // Logado: mostra informações do usuário, esconde o botão de login
          userInfoDiv.style.display = 'block';
          loginPromptDiv.style.display = 'none';
          userEmailSpan.textContent = user.email;
        } else {
          // Deslogado: esconde informações do usuário, mostra o botão de login
          userInfoDiv.style.display = 'none';
          loginPromptDiv.style.display = 'block';
        }
      };
      
      // Inicia e verifica se já existe um usuário logado
      netlifyIdentity.on('init', user => {
        updateUserUI(user);
      });

      // O que fazer após o login
      netlifyIdentity.on('login', user => {
        updateUserUI(user);
        netlifyIdentity.close(); // Fecha o modal de login
      });

      // O que fazer após o logout
      netlifyIdentity.on('logout', () => {
        updateUserUI(null);
      });

      // Abre o modal de login/cadastro do Netlify
      loginButton.addEventListener('click', () => {
        netlifyIdentity.open();
      });

      // Faz o logout do usuário
      logoutButton.addEventListener('click', () => {
        netlifyIdentity.logout();
      });

      document.getElementById('year').textContent = new Date().getFullYear();
    });
  </script>
</body>
</html>